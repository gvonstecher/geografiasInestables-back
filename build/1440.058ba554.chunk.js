"use strict";(self.webpackChunkback=self.webpackChunkback||[]).push([[1440],{27661:(j,L,r)=>{var p=r(67294);const D=(0,p.createContext)();var M=null},21440:(j,L,r)=>{r.d(L,{PL:()=>U,Y9:()=>x.Y,zE:()=>ae,Ky:()=>Q,fi:()=>se,zH:()=>de,r5:()=>o});var p=r(67294),D=r(86706),M=r(25398);const U=()=>{const e=(0,D.v9)(M.Z),n=(0,p.useCallback)(t=>e?.components?.[t]??{},[e]);return{...e,getComponentLayout:n}};var x=r(79116),R=r(60797),C=r(52861),k=r(42225),T=r(18172);const v={error:null,isLoading:!0,layout:{},layouts:{}},V=(e,n)=>(0,T.ZP)(e,t=>{switch(n.type){case"GET_DATA":{t.isLoading=!0,t.error=null,t.layout={};break}case"GET_DATA_SUCCEEDED":{const i=n.data.contentType.uid;t.layout=n.data,t.layouts[i]=n.data,t.isLoading=!1;break}case"GET_DATA_ERROR":{t.isLoading=!1,t.error=n.error;break}case"SET_LAYOUT_FROM_STATE":{t.error=null,t.layout=e.layouts[n.uid];break}case"UPDATE_LAYOUT":{const i=e.layout;t.layout={...i,contentType:{uid:i.contentType.uid,...n.newLayout.contentType}},t.layouts[i.contentType.uid]={...i,contentType:{uid:i.contentType.uid,...n.newLayout.contentType}};break}default:return t}});var w=r(50361),I=r.n(w),_=r(27361),A=r.n(_),oe=r(36968),S=r.n(oe),q=r(21892);const z=(e,n)=>n.find(t=>t.uid===e),ie=(e,n)=>{const t=ee(e,n),i=P(t.contentType,n),m=te(t.contentType,t.components);return S()(t,["contentType","layouts","edit"],i),S()(t,["contentType","layouts","list"],m),Object.keys(t.components).forEach(l=>{const g=P(t.components[l],n);S()(t,["components",l,"layouts","edit"],g)}),t},ee=(e,n)=>{const t=(0,q.w8)(I()(e),n,"contentType"),{components:i,contentType:m}=t,l=g=>Object.keys(g.metadatas).reduce((f,b)=>{const N=A()(g,["attributes",b],{});let F=g.metadatas[b];if(N.type==="relation"){const ye=z(N.targetModel,n),W=F.edit.mainField,X={name:W,schema:A()(ye,["attributes",W])};F={list:{...F.list,mainField:X},edit:{...F.edit,mainField:X}}}return f[b]=F,f},{});return S()(t,["contentType","metadatas"],l(m)),Object.keys(i).forEach(g=>{const f=i[g],b=l(f);S()(t,["components",g,"metadatas"],b)}),t},P=(e,n)=>e.layouts.edit.reduce((t,i)=>{const m=i.map(l=>{const g=A()(e,["attributes",l.name],{}),f={...l,fieldSchema:g,metadatas:A()(e,["metadatas",l.name,"edit"],{})};if(g.type==="relation"){const N=z(g.targetModel,n).pluginOptions||{};S()(f,"targetModelPluginOptions",N),S()(f,"queryInfos",{shouldDisplayRelationLink:B(e,l.name,n)})}return f});return t.push(m),t},[]),te=(e,n)=>e.layouts.list.reduce((i,m)=>{const l=A()(e,["attributes",m],{}),g=A()(e,["metadatas",m,"list"],{}),f=l.type;if(f==="relation")return i.push({key:`__${m}_key__`,name:m,fieldSchema:l,metadatas:g}),i;if(f==="component"){const b=n[l.component],N=b.settings.mainField,F=b.attributes[N];return i.push({key:`__${m}_key__`,name:m,fieldSchema:l,metadatas:{...g,mainField:{...F,name:N}}}),i}return i.push({key:`__${m}_key__`,name:m,fieldSchema:l,metadatas:g}),i},[]),B=(e,n,t)=>{const i=A()(e,["attributes",n,"targetModel"],"");return K(t).includes(i)},K=e=>e.filter(n=>n.isDisplayed).map(({uid:n})=>n),Z=ie,ae=e=>{const[{error:n,isLoading:t,layout:i,layouts:m},l]=(0,p.useReducer)(V,v),g=(0,p.useMemo)(k.Vo,[]),{schemas:f}=(0,D.v9)(W=>g(W),D.wU),b=(0,p.useRef)(!0),{get:N}=(0,R.kY)(),F=(0,p.useCallback)(async(W,X)=>{if(m[W]){l({type:"SET_LAYOUT_FROM_STATE",uid:W});return}l({type:"GET_DATA"});try{const{data:{data:re}}=await N(`/content-manager/content-types/${W}/configuration`,{cancelToken:X.token});l({type:"GET_DATA_SUCCEEDED",data:Z(re,f)})}catch(re){if(C.default.isCancel(re))return;b.current&&console.error(re),b.current&&l({type:"GET_DATA_ERROR",error:re})}},[m,f,N]);(0,p.useEffect)(()=>()=>{b.current=!1},[]),(0,p.useEffect)(()=>{const X=C.default.CancelToken.source();return F(e,X),()=>{X.cancel("Operation canceled by the user.")}},[e,F]);const ye=(0,p.useCallback)(W=>{l({type:"UPDATE_LAYOUT",newLayout:Z(W,f)})},[f]);return{error:n,isLoading:t,layout:i,updateLayout:ye}},ge=e=>e["content-manager_app"].collectionTypeLinks;var ce=r(13218),h=r.n(ce),H=r(80129);const ue=(e,n)=>Object.keys(e).reduce((t,i)=>{const m=e[i],l=A()(n,[i],m);return h()(m)?{...t,[i]:ue(m,l)}:(t[i]=l,t)},{}),le=(e,n,t)=>{const i=e.find(({to:F})=>F.includes(n));if(!i)return"/";const{to:m,search:l}=i,g=(0,H.parse)(l),f=(0,H.parse)(t.substring(1)),b=ue(g,f);return`${m}?${(0,H.stringify)(b,{encode:!1})}`},Q=e=>{const[{rawQuery:n}]=(0,R.Kx)(),t=(0,D.v9)(ge);return le(t,e,n)};var Te=r(25950),Y=r(16550);const se=()=>{const{search:e}=(0,Y.TH)(),n=e?(0,H.parse)(e.substring(1)):{};return n.plugins?(0,H.stringify)({plugins:n.plugins},{encode:!1}):""},de=e=>{const n=(0,p.useRef)();return(0,p.useEffect)(()=>{n.current=e},[e]),n.current};var J=r(14996);const me=(e,n,t)=>({type:J.m,permissions:e,__meta__:{plugins:n,containerName:t}}),fe=()=>({type:J.Q}),s=e=>e["content-manager_rbacManager"].permissions,u=e=>e.rbacProvider.collectionTypesRelatedPermissions,o=(e,n,t="listView")=>{const i=(0,D.I0)(),m=(0,D.v9)(u),l=(0,D.v9)(s),g=m[n];(0,p.useEffect)(()=>g?(i(me(g,e?e.plugins:null,t)),()=>{i(fe())}):()=>{},[g,i,e,t]);const f=l?.some(b=>b.subject!==n)??!0;return{isValid:l&&!f,permissions:l}};var d=r(27661);const y=()=>useContext(WysiwygContext),c=null},79116:(j,L,r)=>{r.d(L,{Y:()=>U});var p=r(67294),D=r(99168),M=r.n(D),O=r(25950);const U=(x,{type:R="STRAPI_DND",index:C,item:k={},onStart:T,onEnd:v,onGrabItem:$,onDropItem:V,onCancel:w,onMoveItem:I,dropSensitivity:_="regular"})=>{const A=(0,p.useRef)(null),[{handlerId:oe},S]=(0,D.useDrop)({accept:R,collect(P){return{handlerId:P.getHandlerId()}},hover(P,te){if(!A.current)return;const B=P.index,K=C;if(B!==K){if(_==="regular"){const Z=A.current.getBoundingClientRect(),ne=(Z.bottom-Z.top)/2,G=te.getClientOffset().y-Z.top;if(B<K&&G<ne||B>K&&G>ne)return}I(K,B),P.index=K}}}),[{isDragging:q},z,ie]=(0,D.useDrag)({type:R,item(){T&&T();const{width:P}=A.current?.getBoundingClientRect()??{};return{index:C,width:P,...k}},end(){v&&v()},canDrag:x,isDragging:k.id?P=>k.id===P.getItem().id:void 0,collect:P=>({isDragging:P.isDragging()})}),ee=(0,O.A)(x,C,{onGrabItem:$,onDropItem:V,onCancel:w,onMoveItem:I});return[{handlerId:oe,isDragging:q,handleKeyDown:ee},A,S,z,ie]}},25950:(j,L,r)=>{r.d(L,{A:()=>D});var p=r(67294);const D=(M,O,{onCancel:U,onDropItem:x,onGrabItem:R,onMoveItem:C})=>{const[k,T]=(0,p.useState)(!1),v=I=>{k&&(I==="UP"?C(O-1,O):I==="DOWN"&&C(O+1,O))},$=()=>{k?(x&&x(O),T(!1)):(R&&R(O),T(!0))},V=()=>{k&&(T(!1),U&&U(O))};return I=>{if(M&&!(I.key==="Tab"&&!k))switch(I.preventDefault(),I.key){case" ":case"Enter":$();break;case"Escape":V();break;case"ArrowDown":case"ArrowRight":v("DOWN");break;case"ArrowUp":case"ArrowLeft":v("UP");break;default:}}}},42225:(j,L,r)=>{r.d(L,{Jg:()=>C,KQ:()=>x,Vo:()=>R,Yg:()=>M});var p=r(20573),D=r(23301);const M=()=>T=>T["content-manager_app"]||D.E,O=()=>createSelector(M(),T=>T),U=()=>createSelector(M(),T=>T.models),x=()=>(0,p.P1)(M(),T=>({collectionTypeLinks:T.collectionTypeLinks,singleTypeLinks:T.singleTypeLinks})),R=()=>(0,p.P1)(M(),({components:T,models:v})=>({schemas:[...T,...v]})),C=(0,p.P1)(M(),T=>T.fieldSizes);var k=null},25398:(j,L,r)=>{r.d(L,{Z:()=>D});const D=M=>M["content-manager_editViewLayoutManager"].currentLayout},56837:(j,L,r)=>{r.d(L,{Z:()=>p});const p={COMPONENT:"component",EDIT_FIELD:"editField",FIELD:"field",DYNAMIC_ZONE:"dynamicZone",RELATION:"relation"}},45283:(j,L,r)=>{r.d(L,{Z:()=>D});const D=M=>`content-manager.${M}`},21892:(j,L,r)=>{r.d(L,{_Q:()=>K.Z,W3:()=>O,ko:()=>x,FE:()=>C,Di:()=>$,Ex:()=>fe,du:()=>_,TA:()=>S,Ts:()=>ee,Uo:()=>te,OB:()=>B.Z,w8:()=>ce,kc:()=>ue});var p=r(50361),D=r.n(p);const O=(s,u,a)=>{if(Array.isArray(s)&&u>=0&&a>=0&&u<=s.length-1&&a<=s.length-1){const o=D()(s),d=o.splice(u,1);return o.splice(a,0,d[0]),o}return s},x=s=>{const{type:u}=s;return u==="relation"?!(s?.relationType??"").toLowerCase().includes("morph"):!["json","dynamiczone","richtext","password"].includes(u)&&!!u},R=(s,u)=>{typeof s=="function"?s(u):s!=null&&(s.current=u)},C=(...s)=>u=>s.forEach(a=>R(a,u));var k=r(27361),T=r.n(k);const v=(s,u)=>Object.keys(s).reduce((a,o)=>{const d=T()(s,[o],{}),{default:y,component:c,type:e,required:n,min:t,repeatable:i}=d;if(y!==void 0&&(a[o]=y),e==="component"){const m=u?.[c]?.attributes??{},l=v(m,u);if(n===!0&&(a[o]=i===!0?[]:l),t&&i===!0&&n){a[o]=[];for(let g=0;g<t;g+=1)a[o].push(l)}}return e==="dynamiczone"&&n===!0&&(a[o]=[]),a},{}),$=v;var V=r(57557),w=r.n(V);const _=({layouts:s,metadatas:u,...a})=>{const o=s.list.map(c=>c.name?c.name:c),d=Object.keys(u).reduce((c,e)=>{const n=T()(u,[e],{});let t=n.edit;return t.mainField&&(t={...t,mainField:n.edit.mainField.name}),{...c,[e]:{edit:t,list:w()(n.list,["mainField"])}}},{}),y=s.edit.map(c=>c.map(({name:e,size:n})=>({name:e,size:n})));return{...a,layouts:{edit:y,list:o},metadatas:d}},A=(s,u)=>s.map(a=>({...a,subject:u})),S=s=>{const u={create:[{action:"plugin::content-manager.explorer.create",subject:null}],delete:[{action:"plugin::content-manager.explorer.delete",subject:null}],publish:[{action:"plugin::content-manager.explorer.publish",subject:null}],read:[{action:"plugin::content-manager.explorer.read",subject:null}],update:[{action:"plugin::content-manager.explorer.update",subject:null}]};return Object.keys(u).reduce((a,o)=>(a[o]=A(u[o],s),a),{})};var q=r(7654),z=r.n(q);const ee=s=>s.split(".").filter(u=>z()(parseInt(u,10))),te=s=>{if(s.length===0)return-1;const u=Math.max.apply(Math,s.map(a=>a.__temp_key__??0));return Number.isNaN(u)?-1:u};var B=r(45283),K=r(56837),Z=r(82492),ne=r.n(Z),ae=r(36968),G=r.n(ae);const ce=(s,u,a)=>{const o=e=>u.find(n=>n.uid===e),d=Object.assign({},s),y=s[a].uid,c=o(y);return G()(d,[a],ne()({},c,s[a])),Object.keys(s.components).forEach(e=>{const n=o(e);G()(d,["components",e],{...s.components[e],...n})}),d};var h=r(60797);const ue=(s,u,a)=>{const o=(d,y)=>Object.keys(d).reduce((c,e)=>{const n=(0,h.UN)(y,e),t=T()(d,e),i=(0,h.k2)(y,[e,"component"]),m=(0,h.k2)(y,[e,"repeatable"]);return n==="dynamiczone"?(c[e]=t.map(l=>o(l,a[l.__component])),c):n==="component"?(m?c[e]=t&&t.map(l=>o(l,a[i])):c[e]=t&&o(t,a[i]),c):(n!=="password"&&(c[e]=t),c)},{});return o(s,u)};var pe=r(51584),le=r.n(pe),he=r(41609),Q=r.n(he),Te=r(14841),Y=r.n(Te),E=r(87561),se=r(72262);E.kM(E.nK,"defined",function(){return this.test("defined",h.I0.required,s=>s!==void 0)}),E.kM(E.IX,"notEmptyMin",function(s){return this.test("notEmptyMin",h.I0.min,u=>Q()(u)?!0:u.length>=s)}),E.kM(E.Z_,"isInferior",function(s,u){return this.test("isInferior",s,function(a){return!a||Number.isNaN(Y()(a))?!0:Y()(u)>=Y()(a)})}),E.kM(E.Z_,"isSuperior",function(s,u){return this.test("isSuperior",s,function(a){return!a||Number.isNaN(Y()(a))?!0:Y()(a)>=Y()(u)})});const de=s=>T()(s,["attributes"],{}),J=(s,{components:u},a={isCreatingEntry:!0,isDraft:!0,isFromComponent:!1})=>{const o=de(s);return E.Ry().shape(Object.keys(o).reduce((d,y)=>{const c=o[y];if(c.type!=="relation"&&c.type!=="component"&&c.type!=="dynamiczone"){const e=me(c.type,c,a);d[y]=e}if(c.type==="relation"&&(d[y]=["oneWay","oneToOne","manyToOne","oneToManyMorph","oneToOneMorph"].includes(c.relationType)?E.Ry().nullable():E.IX().nullable()),c.type==="component"){const e=J(u[c.component],{components:u},{...a,isFromComponent:!0});if(c.repeatable===!0){const{min:t,max:i,required:m}=c;let l=E.Vo(g=>{let f=E.IX().of(e);return t?m?f=f.min(t,h.I0.min):m!==!0&&Q()(g)?f=f.nullable():f=f.min(t,h.I0.min):m&&!a.isDraft&&(f=f.min(1,h.I0.required)),i&&(f=f.max(i,h.I0.max)),f});return d[y]=l,d}const n=E.Vo(t=>t!==void 0?c.required===!0&&!a.isDraft?e.defined():e.nullable():c.required===!0?E.Ry().defined():E.Ry().nullable());return d[y]=n,d}if(c.type==="dynamiczone"){let e=E.IX().of(E.Vo(({__component:i})=>J(u[i],{components:u},{...a,isFromComponent:!0})));const{max:n,min:t}=c;t?c.required?e=e.test("min",h.I0.min,i=>a.isCreatingEntry?i&&i.length>=t:i===void 0?!0:i!==null&&i.length>=t).test("required",h.I0.required,i=>a.isCreatingEntry?i!==null||i!==void 0:i===void 0?!0:i!==null):e=e.notEmptyMin(t):c.required&&!a.isDraft&&(e=e.test("required",h.I0.required,i=>a.isCreatingEntry?i!==null||i!==void 0:i===void 0?!0:i!==null)),n&&(e=e.max(n,h.I0.max)),d[y]=e}return d},{}))},me=(s,u,a)=>{let o=E.nK();return["string","uid","text","richtext","email","password","enumeration"].includes(s)&&(o=E.Z_()),s==="json"&&(o=E.nK(h.I0.json).test("isJSON",h.I0.json,d=>{if(!d||!d.length)return!0;try{return JSON.parse(d),!0}catch{return!1}}).nullable().test("required",h.I0.required,d=>!(u.required&&(!d||!d.length)))),s==="email"&&(o=o.email(h.I0.email)),["number","integer","float","decimal"].includes(s)&&(o=E.Rx().transform(d=>z()(d)?void 0:d).typeError()),s==="biginteger"&&(o=E.Z_().matches(/^-?\d*$/)),["date","datetime"].includes(s)&&(o=E.hT()),Object.keys(u).forEach(d=>{const y=u[d];if(y||!le()(y)&&Number.isInteger(Math.floor(y))||y===0)switch(d){case"required":{a.isDraft||(s==="password"&&a.isCreatingEntry&&(o=o.required(h.I0.required)),s!=="password"&&(a.isCreatingEntry?o=o.required(h.I0.required):o=o.test("required",h.I0.required,c=>c===void 0&&!a.isFromComponent?!0:(0,se.Z)(s)?c===0?!0:!!c:s==="boolean"?c!=null:s==="date"||s==="datetime"?typeof c=="string"?!Q()(c):!Q()(c?.toString()):!Q()(c))));break}case"max":{s==="biginteger"?o=o.isInferior(h.I0.max,y):o=o.max(y,h.I0.max);break}case"maxLength":o=o.max(y,h.I0.maxLength);break;case"min":{s==="biginteger"?o=o.isSuperior(h.I0.min,y):o=o.min(y,h.I0.min);break}case"minLength":{a.isDraft||(o=o.min(y,h.I0.minLength));break}case"regex":o=o.matches(new RegExp(y),{message:h.I0.regex,excludeEmptyString:!u.required});break;case"lowercase":["text","textarea","email","string"].includes(s)&&(o=o.strict().lowercase());break;case"uppercase":["text","textarea","email","string"].includes(s)&&(o=o.strict().uppercase());break;case"positive":(0,se.Z)(s)&&(o=o.positive());break;case"negative":(0,se.Z)(s)&&(o=o.negative());break;default:o=o.nullable()}}),o},fe=J},72262:(j,L,r)=>{r.d(L,{Z:()=>p});function p(D){return["integer","biginteger","decimal","float","number"].includes(D)}}}]);
